-가비지 컬렉션

GC ( 가비지 컬렉션 )의 동작 원리

⨀ C# 메모리 할당
- C#은 선형적인 Heap 메모리를 가지고 있으며, 메모리 할당을 위한 포인터 만을 가지고 있음
- 메모리 할당이 필요한 경우 현재 필요한 메모리 크기만큼 증가시키고 0세대값으로 설정. 포인터는 증가된 크기만큼 이동 시킴 
- 할당을 위한 충분한 메모리가 없을 경우, GC가 호출되고 GC가 호출됨에도 충분한 메모리가 없을 경우에는 Heap메모리가 확장 됨. 대부분의 Unity 플램폼의 경우 힙의 크기를 2배로 늘림
- 만일 사용 가능한 메모리 공간이 부족해지는 경우 앱이 강제 종료 됨

⨀ C# 메모리 해제
- GC 는 시스템의 실제 메모리가 부족 하거나, Managed Heap에 할당된 개체에 사용되는 메모리가 허용되는 임계 값을 넘었을 때, GC.Collect 메서드가 호출 될 때 발생
- GC는 힙 메모리 상에서 사용 중인 객체들의 참조 그래프를 가지고 있으며, 이를 통해 현재 사용 중이지 않은 메모리를 해제하고 사용 중인 메모리는 재배치를 하게 됨
- 참조 그래프의 Root는 Stack에 있는 로벌 켠수, 정적 빌드, 전역 변수 등이 되고, 하위는 객체 간의 참조가 될 수 있음

⨀ 세대별 가비지 컬렉션
-최근에 할당된 메모리부터 GC가 한번 불릴 때마다 살아 남은 메모리까지 0 ~ 2 세대까지 분리
- 최근에 생성될 객체일 수록 메모리 해제가 발생할 가능성이 높기 때문에 0 세대의 메모리 부터 관리
- 0세대의 GC에서 남아 있는 메모리는 1세대로 변경 됨, 1세대의 GC가 발생하고 남이 있는 1세대는 2세대로 변경 됨
- 0 세대의 메모리 관리 후에도 메모리가 부족해지면 1세대 -> 2세대 순으로 메모리를 관리
